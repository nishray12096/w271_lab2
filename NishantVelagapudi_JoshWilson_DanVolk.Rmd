---
title: "NishantVelagapudi_JoshWilson_DanVolk"
author: "Nishant Velagapudi, Josh Wilson, Dan Volk"
date: "February 15, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Read in Data

```{r cars}

pkg <- c('car', 'plyr', 'ggplot2', 'Hmisc', 'stargazer',
         'ggpubr', 'gridExtra')

lapply(pkg, require, character.only = T)

#change to your git location
setwd("~/Berkeley_MIDS_Homework/W271/Lab2/w271_lab2")

data <- read.csv("DeHartSimplified.csv", sep=",")
```

# Variables
id:
studyday:
dayweek: day of week (saturday == 6)
numall: number of alcoholic beverages consumed on that day
nrel: negative romantic relationship event
prel: positive romantic relatinship event
negevent: number & intensity of negative events in a day (0-3)
posevent: number & intensity of positive events in a day (0-3)
gender: male (1) female (2)
rosn: trait self-esteem
age:
desired: desire to drink each day, higher number corresponds to more desire
state: short-term self-esteem state

## Univariate Analysis

```{r}
summary(data)

par(mfrow=c(1,3))

#Variables of immediate interest: rosn = self-worth, nrel=negative relationship interactions, desired = desire to drink
hist(data$rosn)
hist(data$nrel)
hist(data$desired)
hist(data$numall)
#We see that Id identifies a single respondant: each respondant has 7 responses (one for each day of the week)
count(data, id)

#We see a skewed response distribution by gender
count(data, gender)


```

## Bivariate Analysis
```{r}
#Split out three variables of interest by gender

biv_1 <- ggplot(data, aes(factor(gender), rosn)) + geom_boxplot(aes(fill=factor(gender))) +
         geom_jitter(width=0.1) + xlab("Gender")       + ggtitle("Self-worth")      +
         theme(plot.title=element_text(lineheight=1, face="bold"))

biv_2 <- ggplot(data, aes(factor(gender), negevent)) + geom_boxplot(aes(fill=factor(gender))) +
         geom_jitter(width=0.1) + xlab("negevent")       + ggtitle("Neg. Rel. Events")      +
         theme(plot.title=element_text(lineheight=1, face="bold"))

biv_3 <- ggplot(data, aes(factor(gender), desired)) + geom_boxplot(aes(fill=factor(gender))) +
         geom_jitter(width=0.1) + xlab("desired")       + ggtitle("Drinking Desire")      +
         theme(plot.title=element_text(lineheight=1, face="bold"))

ggarrange(biv_1, biv_2, biv_3, ncol=3, common.legend = TRUE, legend="bottom")
```

```{r, warning=FALSE}
scatterplotMatrix(data[c("nrel","desired","rosn")])
```


```{r More EDA}

# Does  self esteem relate to desire to drink
ggplot(data = data, aes(x = rosn, y = desired)) + geom_point(alpha = 0.3) +
  geom_smooth() + xlab("Self-Esteem") + ylab("Desire to Drink")

# Does Negative Romantic events relate to the desire to drink
ggplot(data = data, aes(x = nrel, y = desired)) + geom_point(alpha = 0.3) +
  geom_smooth() + xlab("Negative Romantic Events") + ylab("Desire to Drink")

# Does Self-Esteem  relate to Total drink consumption
ggplot(data = data, aes(x = rosn, y = numall)) + geom_point(alpha = 0.3) +
  geom_smooth() + xlab("Self-Esteem") + ylab("Total Drink Consumption")

# Looking At the Desire to Drink by Negative Events by Gender
ggplot(data = data, aes(x = rosn, y = desired, fill = as.factor(gender))) + geom_point(alpha = 0.3) +
  geom_smooth() + xlab("Self-Esteem") + ylab("Desire to Drink")

# Does self-esteem vary by gender?
ggplot(data = data, aes(x = as.factor(gender), y = rosn)) + geom_boxplot(aes(fill=factor(gender))) + geom_jitter(width=0.1)

# Does self-esteem vary by age
ggplot(data = data, aes(x = age, y = rosn)) + geom_point(alpha = 0.3) +
  geom_smooth() + xlab("Age") + ylab("Self-Esteem")


```